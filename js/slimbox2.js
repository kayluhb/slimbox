/*!
	Slimbox v2.04 - The ultimate lightweight Lightbox clone for jQuery
	(c) 2007-2010 Christophe Beyls <http://www.digitalia.be>
	MIT-style license.
	
	Updates and maintenance by @kayluhb 2013
*/
(function(e){function k(){}function L(n){if(n){e("object").add("embed").each(function(e,t){h[e]=[t,t.style.visibility];t.style.visibility="hidden"})}else{e.each(h,function(e,t){t[0].style.visibility=t[1]});h=[]}var r=n?"on":"off";t[r]("scroll resize",k);e(document)[r]("keydown",A)}function A(t){var r=t.keyCode,i=e.inArray;return i(r,n.closeKeys)>=0?B():i(r,n.nextKeys)>=0?M():i(r,n.previousKeys)>=0?O():false}function O(){return _(o)}function M(){return _(u)}function _(e){if(e>=0){i=e;s=r[i][0];o=(i||(n.loop?r.length:0))-1;u=(i+1)%r.length||(n.loop?0:-1);H();y[0].className="lb-loading";d=new Image;d.onload=D;d.src=s}return false}function D(){y.className="";var e=b;e.css({backgroundImage:"url("+s+")",visibility:"hidden",display:""});w.width(d.width).height(d.height);N.html(r[i][1]||"");C.html((r.length>1&&n.counterText||"").replace(/\{x\}/,i+1).replace(/\{y\}/,r.length));if(o>=0){v.src=r[o][0]}if(u>=0){m.src=r[u][0]}var a=t.height()-n.padding,h=t.width()-n.padding;l=b[0].offsetWidth;c=b[0].offsetHeight;if(c>a){l=l*(a/c);c=a}if(l>h){c=c*(h/l);l=h}var p=Math.max(0,f-c*.5)-20;if(y[0].offsetHeight!=c){y.animate({height:c,top:p},n.resizeDuration,n.resizeEasing)}if(y[0].offsetWidth!=l){y.animate({width:l,marginLeft:-l*.5},n.resizeDuration,n.resizeEasing)}y.queue(function(){x.css({width:l,top:p+c,marginLeft:-l*.5,visibility:"hidden",display:""});e.css({backgroundSize:l+"px "+c+"px",display:"none",visibility:"",opacity:""}).fadeIn(n.imageFadeDuration,P)})}function P(){if(o>=0){E.show()}if(u>=0){S.show()}T.css("marginTop",-T[0].offsetHeight).animate({marginTop:0},n.captionAnimationDuration);x.css({visibility:""})}function H(){d.onload=null;d.src=v.src=m.src=s;y.stop();b.stop();T.stop();E.hide();S.hide();b.hide();x.hide()}function B(){if(i>=0){H();i=o=u=-1;y.hide();g.stop().fadeOut(n.overlayFadeDuration,L)}return false}var t=e(window),n,r,i=-1,s,o,u,a,f,l,c,h=[],p=document.documentElement,d={},v=new Image,m=new Image,g,y,b,w,E,S,x,T,N,C;e(function(){g=e('<div id="lb-overlay"></div>');y=e('<div id="lb-center"></div>');b=e('<div id="lb-image"></div>');w=e('<div style="position:relative;" />');b.append(w);y.append(b);x=e('<div id="lb-bottom-container">').css({display:"none"});T=e('<div id="lb-bottom" class="clearfix"></div>');N=e('<div id="lb-caption"></div>');C=e('<div id="lb-number"></div>');E=e('<a id="lb-prev-link" href="#"></a>');S=e('<a id="lb-next-link" href="#"></a>');T.append(N,C,E,S);x.append(T);e("body").append(g,y,x);E.click(O);S.click(M);g.click(B)});e.slimbox=function(i,s,o){n=e.extend({loop:false,overlayOpacity:.8,overlayFadeDuration:400,resizeDuration:200,resizeEasing:"swing",initialWidth:250,initialHeight:250,imageFadeDuration:400,captionAnimationDuration:300,counterText:"Image {x} of {y}",closeKeys:[27,88,67],previousKeys:[37,80],nextKeys:[39,78],padding:80},o);if(typeof i=="string"){i=[[i,s]];s=0}f=t.scrollTop()+t.height()*.5;l=n.initialWidth;c=n.initialHeight;y.css({top:Math.max(0,f-c*.5),width:l,height:c,marginLeft:-l*.5}).show();a=g.currentStyle&&g.currentStyle.position!="fixed";if(a){g.css({position:"absolute"})}g.css("opacity",n.overlayOpacity).fadeIn(n.overlayFadeDuration);k();L(1);r=i;n.loop=n.loop&&r.length>1;return _(s)};e.fn.slimbox=function(t,n,r){n=n||function(e){return[e.href,e.title]};r=r||function(){return true};var i=this;return i.off("click").click(function(){var s=this,o=0,u,a=0,f;u=e.grep(i,function(e,t){return r.call(s,e,t)});for(f=u.length;a<f;++a){if(u[a]==s)o=a;u[a]=n(u[a],a)}return e.slimbox(u,o,t)})}})(jQuery)

// AUTOLOAD CODE BLOCK (MAY BE CHANGED OR REMOVED)
if (!/android|iphone|ipod|series60|symbian|windows ce|blackberry/i.test(navigator.userAgent)) {
	jQuery(function($) {
		$("a[rel^='lightbox']").slimbox({/* Put custom options here */}, null, function(el) {
			return (this == el) || ((this.rel.length > 8) && (this.rel == el.rel));
		});
	});
}
